{"version":3,"sources":["components/CheckPointByCode/style.module.css","services/authService.ts","icons/qr_code_scanner_black_24dp.svg","icons/flip_camera_android_black_24dp.svg","components/QRScanner/index.tsx","helpers/distanceHelper.ts","components/CheckPointByCode/index.tsx","helpers/formatHelper.ts","components/MainScreen/index.tsx","App.tsx","reportWebVitals.ts","index.tsx","components/QRScanner/style.module.css","components/MainScreen/style.module.css"],"names":["module","exports","client_id","a","fetch","URLSearchParams","access_token","toString","method","then","res","json","localStorage","clear","Promise","resolve","success","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","fill","height","width","d","SvgQrCodeScannerBlack24Dp","_ref","svgRef","title","titleId","props","xmlns","enableBackground","viewBox","ref","id","ForwardRef","SvgFlipCameraAndroidBlack24Dp","QRScanner","onChange","React","useState","mode","setMode","val","setVal","className","style","qrScanner","cameraSwitchBtn","onClick","m","header","onDoubleClick","delay","onError","err","console","log","onScan","data","facingMode","getDistanceBetweenPointsInMeters","lat1","lon1","lat2","lon2","φ1","Math","PI","φ2","Δφ","Δλ","sin","cos","atan2","sqrt","CheckPointByCode","code","points","lat","setLat","lng","setLng","status","setStatus","getLocation","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","useEffect","point","find","dist","toFixed","href","name","description","mapBackPointToFront","backModel","split","map","Number","MainScreen","scan","setScan","setCode","setPoints","credentials","ololo","e","App","userData","setUserData","setErr","rawUserData","undefined","message","get","window","location","redirect_uri","origin","response_type","approval_prompt","scope","searchParams","entries","forEach","append","getAuthLink","textAlign","lineHeight","padding","float","unAuthorizeAsync","src","photo","surname","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.3eefd69f.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"qrScanner\":\"style_qrScanner__3EnCA\",\"header\":\"style_header__3T4Oc\",\"cameraSwitchBtn\":\"style_cameraSwitchBtn__1-pio\"};","const client_id = '73436';\r\nconst client_secret = 'ba9fb913d81fc6941fe0d6e96011de332fff2697';\r\nconst lsTokenKey = 'snpnz_token';\r\nconst lsUserKey = 'snpnz_user';\r\n\r\nexport function getAuthLink() {\r\n    const data = {\r\n        client_id,\r\n        redirect_uri: 'http://localhost/oauth/?redir='+window.location.origin,\r\n        response_type: 'code',\r\n        approval_prompt : 'auto',\r\n        scope: 'activity:read',\r\n    };\r\n\r\n    const searchParams = new URLSearchParams();\r\n    Object.entries(data).forEach(([key, val]) => searchParams.append(key, val))\r\n\r\n    return `https://www.strava.com/oauth/authorize?${searchParams.toString()}`;\r\n}\r\n\r\nexport async function getAuthTokenAsync() {\r\n    const lsTokenDataStr = localStorage.getItem(lsTokenKey);\r\n\r\n    if (lsTokenDataStr && lsTokenDataStr.length) {\r\n        const tData = JSON.parse(lsTokenDataStr);\r\n        if (tData.expires_at && tData.expires_at * 1000 > Date.now()) {\r\n            return tData.access_token;\r\n        }\r\n\r\n        if (tData.refresh_token) {\r\n\r\n                const result = await fetch(\"https://www.strava.com/api/v3/oauth/token\", {\r\n                    body: new URLSearchParams({\r\n                        client_id,\r\n                        client_secret,\r\n                        refresh_token: tData.refresh_token,\r\n                        grant_type: 'refresh_token'\r\n                    }).toString(),\r\n                    headers: {\r\n                        \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n                    },\r\n                    method: \"POST\"\r\n                }).then(res => res.json());\r\n                localStorage.setItem(lsTokenKey, JSON.stringify(result));\r\n\r\n                return result.access_token;\r\n        }\r\n\r\n        throw new Error('no token');\r\n    } else {\r\n        throw new Error('no stored token data');\r\n    }\r\n}\r\n\r\nexport async function setAuthTokenByCodeAsync(code:string) {\r\n        const result = await fetch(\"https://www.strava.com/api/v3/oauth/token\", {\r\n            body: new URLSearchParams({\r\n                client_id,\r\n                client_secret,\r\n                code,\r\n                grant_type: 'authorization_code'\r\n            }).toString(),\r\n            headers: {\r\n                \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n            },\r\n            method: \"POST\"\r\n        }).then(res => res.json());\r\n\r\n        console.log({result})\r\n        const { athlete, ...tokenData } = result;\r\n\r\n        localStorage.setItem(lsUserKey, JSON.stringify(athlete));\r\n        localStorage.setItem(lsTokenKey, JSON.stringify(tokenData));\r\n\r\n        return result.access_token;\r\n}\r\n\r\nexport async function unAuthorizeAsync(){\r\n    const access_token = '';\r\n        await fetch(\r\n            `https://www.strava.com/oauth/deauthorize?${new URLSearchParams({ access_token }).toString()}`,\r\n            { method: \"POST\" }\r\n        ).then(res => res.json());\r\n        localStorage.clear();\r\n\r\n        return Promise.resolve({ success: true });\r\n}\r\n\r\nexport function getUser() {\r\n    return JSON.parse(localStorage.getItem(lsUserKey) as string);\r\n}","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"rect\", {\n  fill: \"none\",\n  height: 24,\n  width: 24\n});\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M9.5,6.5v3h-3v-3H9.5 M11,5H5v6h6V5L11,5z M9.5,14.5v3h-3v-3H9.5 M11,13H5v6h6V13L11,13z M17.5,6.5v3h-3v-3H17.5 M19,5h-6v6 h6V5L19,5z M13,13h1.5v1.5H13V13z M14.5,14.5H16V16h-1.5V14.5z M16,13h1.5v1.5H16V13z M13,16h1.5v1.5H13V16z M14.5,17.5H16V19h-1.5 V17.5z M16,16h1.5v1.5H16V16z M17.5,14.5H19V16h-1.5V14.5z M17.5,17.5H19V19h-1.5V17.5z M22,7h-2V4h-3V2h5V7z M22,22v-5h-2v3h-3v2 H22z M2,22h5v-2H4v-3H2V22z M2,2v5h2V4h3V2H2z\"\n});\n\nfunction SvgQrCodeScannerBlack24Dp(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    enableBackground: \"new 0 0 24 24\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    width: \"24px\",\n    fill: \"#000000\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2, _ref3);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgQrCodeScannerBlack24Dp);\nexport default __webpack_public_path__ + \"static/media/qr_code_scanner_black_24dp.4ba2e77e.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"rect\", {\n  fill: \"none\",\n  height: 24,\n  width: 24\n}));\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M9,12c0,1.66,1.34,3,3,3s3-1.34,3-3s-1.34-3-3-3S9,10.34,9,12z\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M8,10V8H5.09C6.47,5.61,9.05,4,12,4c3.72,0,6.85,2.56,7.74,6h2.06c-0.93-4.56-4.96-8-9.8-8C8.73,2,5.82,3.58,4,6.01V4H2v6 H8z\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M16,14v2h2.91c-1.38,2.39-3.96,4-6.91,4c-3.72,0-6.85-2.56-7.74-6H2.2c0.93,4.56,4.96,8,9.8,8c3.27,0,6.18-1.58,8-4.01V20 h2v-6H16z\"\n})));\n\nfunction SvgFlipCameraAndroidBlack24Dp(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    enableBackground: \"new 0 0 24 24\",\n    height: \"24px\",\n    viewBox: \"0 0 24 24\",\n    width: \"24px\",\n    fill: \"#000000\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2, _ref3);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgFlipCameraAndroidBlack24Dp);\nexport default __webpack_public_path__ + \"static/media/flip_camera_android_black_24dp.27cf4796.svg\";\nexport { ForwardRef as ReactComponent };","import React from 'react';\r\nimport QrReader from 'react-qr-reader';\r\nimport style from './style.module.css';\r\nimport { ReactComponent as Ic } from '../../icons/flip_camera_android_black_24dp.svg'\r\ninterface IQRScannerProps {\r\n    onChange: (code: string | null) => void\r\n}\r\n\r\nconst QRScanner: React.FC<IQRScannerProps> = ({ onChange }) => {\r\n    const [mode, setMode] = React.useState<'user' | 'environment'>('environment');\r\n    const [val, setVal] = React.useState<string | null>(null);\r\n    const handleError = (err: Error) => {\r\n        console.log(err)\r\n    }\r\n\r\n    const handleScan = (data: string | null) => {\r\n        if (data !== val) {\r\n            data && onChange(data);\r\n            setVal(data);\r\n        }\r\n    }\r\n\r\n    return <div className={style.qrScanner}>\r\n        <button\r\n            className={style.cameraSwitchBtn}\r\n            onClick={() => setMode(m => mode === 'user' ? 'environment' : 'user')}>\r\n            <Ic />\r\n        </button>\r\n        <h3 className={style.header} onDoubleClick={() => onChange('CECUt8XuFLHqLDJt')}>Наведите камеру на QR-код</h3>\r\n        <QrReader\r\n            delay={600}\r\n            onError={handleError}\r\n            onScan={handleScan}\r\n            style={{ width: '100%', height: '100%' }}\r\n            facingMode={mode}\r\n        />\r\n    </div>\r\n}\r\n\r\nexport default QRScanner;","type latlon = [number, number]\r\n/**\r\n * Дистанция между двумя GPS точками в метрах\r\n * @param {Array<number>} latLon1\r\n * @param {Array<number>} latLon2\r\n * @returns {number}\r\n * @link https://www.movable-type.co.uk/scripts/latlong.html\r\n */\r\nexport function getDistanceBetweenPointsInMeters(\r\n    [lat1, lon1]: latlon,\r\n    [lat2, lon2]: latlon\r\n): number {\r\n    const R = 6371e3; // metres\r\n    const φ1 = (lat1 * Math.PI) / 180; // φ, λ in radians\r\n    const φ2 = (lat2 * Math.PI) / 180;\r\n    const Δφ = ((lat2 - lat1) * Math.PI) / 180;\r\n    const Δλ = ((lon2 - lon1) * Math.PI) / 180;\r\n\r\n    const a = Math.sin(Δφ / 2) * Math.sin(Δφ / 2)\r\n        + Math.cos(φ1) * Math.cos(φ2)\r\n        * Math.sin(Δλ / 2) * Math.sin(Δλ / 2);\r\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n\r\n    const d = R * c; // in metres\r\n\r\n    return d;\r\n}\r\n\r\n\r\nexport function getDistanceByCoordsInMeters(latLonArray: latlon[]) {\r\n    return latLonArray.reduce((acc, cur, index, arr) => {\r\n        if (index === 0) {\r\n            return acc;\r\n        }\r\n\r\n        return acc + getDistanceBetweenPointsInMeters(arr[index - 1], cur);\r\n    }, 0);\r\n}\r\n","import React from 'react';\r\nimport style from './style.module.css';\r\nimport {IPoint} from \"../MainScreen\";\r\nimport {getDistanceBetweenPointsInMeters} from \"../../helpers/distanceHelper\";\r\nimport { formatDistance } from '../../helpers/formatHelper';\r\ninterface IQRScannerProps {\r\n    code: string | null,\r\n    points: IPoint[],\r\n}\r\n\r\nconst CheckPointByCode: React.FC<IQRScannerProps> = ({ code, points }) => {\r\n    const [lat, setLat] = React.useState<number | null>(null);\r\n    const [lng, setLng] = React.useState<number | null>(null);\r\n    const [status, setStatus] = React.useState<string | null>(null);\r\n\r\n    const getLocation = () => {\r\n        if (!navigator.geolocation) {\r\n            setStatus('Geolocation is not supported by your browser');\r\n        } else {\r\n            setStatus('Locating...');\r\n            navigator.geolocation.getCurrentPosition((position) => {\r\n                setStatus(null);\r\n                setLat(position.coords.latitude);\r\n                setLng(position.coords.longitude);\r\n            }, () => {\r\n                setStatus('Unable to retrieve your location');\r\n            });\r\n        }\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        getLocation();\r\n    }, []);\r\n\r\n    if (!lat || !lng) {\r\n        return <>\r\n            <button onClick={getLocation}>Get Location</button>\r\n        </>\r\n    }\r\n\r\n\r\n    const point = points.find(point => point.code===code)!;\r\n    const dist = getDistanceBetweenPointsInMeters([point.point[0], point.point[1]], [lat, lng])\r\n\r\n    return <div className={style.qrScanner}>\r\n        <p>{status}</p>\r\n        <b>До точки: {formatDistance(dist)}</b>\r\n        <h3><a href={`geo:${lat},${lng}`}>{point.name}</a></h3>\r\n        <em>{point.description}</em>\r\n    </div>\r\n}\r\n\r\nexport default CheckPointByCode;","/**\r\n * Числительные\r\n * @param {number} number кол-во\r\n * @param {Array<string>} titles ['секунда', 'секунды', 'секунд']\r\n * @returns {string}\r\n * @example declOfNum(5, ['секунда', 'секунды', 'секунд']); // returns 'секунд'\r\n */\r\nexport function declOfNum(num: number, titles: string[]) {\r\n\r\n    const cases = [2, 0, 1, 1, 1, 2];\r\n    return titles[(num % 100 > 4 && num % 100 < 20) ? 2 : cases[(num % 10 < 5) ? num % 10 : 5]];\r\n}\r\n\r\nexport function formatDistance(d: number) {\r\n    if (!(d > 0)) { return '-'; }\r\n    return d > 1000 ? `${(d / 1000).toFixed(2)}\\u202fкм` : `${(d).toFixed()}\\u2009м`;\r\n}","import React from 'react';\r\nimport style from './style.module.css';\r\nimport { ReactComponent as Ic } from '../../icons/qr_code_scanner_black_24dp.svg'\r\nimport QRScanner from \"../QRScanner\";\r\nimport CheckPointByCode from \"../CheckPointByCode\";\r\n\r\nexport interface IPoint {\r\n    id: number;\r\n    name: string;\r\n    point: number[];\r\n    description: string;\r\n    code: string;\r\n}\r\n\r\nconst mapBackPointToFront = (backModel: {[key: string]: string}): IPoint => {\r\n    return {\r\n        code: backModel.code,\r\n        description: backModel.description,\r\n        id: +backModel.id,\r\n        name: backModel.name,\r\n        point: backModel.point.split(',').map(Number)\r\n    }\r\n}\r\n\r\nconst MainScreen: React.FC = () => {\r\n    const [scan, setScan] = React.useState<boolean>(false);\r\n    const [code, setCode] = React.useState<string | null>(null);\r\n    const [points, setPoints] = React.useState<IPoint[] | null>(null);\r\n\r\n    React.useEffect(() => {\r\n        fetch(\r\n            '/api/points/',\r\n            { credentials: 'include'}).then(res => res.json()).then(data => {\r\n            setPoints(data.data.map(mapBackPointToFront));\r\n        });\r\n    }, []);\r\n\r\n    return <div className={style.qrScanner}>\r\n        {!code && <div>\r\n            {!scan && <button\r\n                className={style.ololo}\r\n                onClick={() => setScan(m => !m)}>\r\n                Сканировать QR-код <Ic />\r\n            </button>}\r\n            {scan && <QRScanner onChange={e => {setCode(e);}} />}\r\n        </div>}\r\n        {points && code && <CheckPointByCode code={code} points={points} />}\r\n    </div>\r\n}\r\n\r\nexport default MainScreen;","import { useEffect, useState } from 'react';\r\nimport './App.css';\r\nimport {\r\n  getAuthLink,\r\n  getAuthTokenAsync,\r\n  setAuthTokenByCodeAsync,\r\n  getUser, unAuthorizeAsync\r\n} from './services/authService';\r\nimport QRScanner from \"./components/QRScanner\";\r\nimport {log} from \"util\";\r\nimport MainScreen from \"./components/MainScreen\";\r\n\r\ninterface IUser {\r\n  \"id\": string;\r\n  \"login\": string;\r\n  \"name\": string;\r\n  \"surname\": string;\r\n  \"photo\": string;\r\n  \"strava_id\": string;\r\n  \"register_date\": string;\r\n}\r\n\r\nfunction App() {\r\n  const [userData, setUserData] = useState<IUser | null | undefined>(null);\r\n  const [dbLoading, setDbLoading] = useState(true);\r\n  const [err, setErr] = useState('');\r\n\r\n  useEffect(() => {\r\n\r\n    const get = async () => {\r\n      try {\r\n        const rawUserData = await fetch(\r\n            '/api/user/',\r\n            { credentials: 'include'});\r\n        const userData = await rawUserData.json();\r\n        if (userData.success === false) {\r\n          setUserData(undefined);\r\n        } else {\r\n          setUserData(userData.data);\r\n        }\r\n\r\n      } catch (e) {\r\n        setErr((e as Error).message);\r\n      }\r\n    }\r\n    get().then();\r\n\r\n\r\n  }, []);\r\n\r\n  if (userData === null) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  if (userData === undefined) {\r\n    return (\r\n        <div className=\"App\">\r\n          <button  className=\"bigButton\" onClick={() => window.location.href = getAuthLink()}>Войти в Strava</button>\r\n        </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n      <div className=\"App\">\r\n        {err && <p>{err}</p>}\r\n        <div style={{textAlign:'left', lineHeight: '15px', padding: '8px'}}>\r\n          <button  style={{float:'right'}} onClick={() => unAuthorizeAsync()}>Выйти</button>\r\n          <img src={userData.photo} style={{float:'left'}} width={40} />\r\n          <div>{userData.name}<br />{userData.surname}</div>\r\n        </div>\r\n        <MainScreen />\r\n      </div>\r\n  );\r\n}\r\n\r\nexport default App;","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"qrScanner\":\"style_qrScanner__2lYw-\",\"header\":\"style_header__1iR7_\",\"cameraSwitchBtn\":\"style_cameraSwitchBtn__2J7TV\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"qrScanner\":\"style_qrScanner__kZ0Oc\",\"header\":\"style_header__2qZXV\",\"cameraSwitchBtn\":\"style_cameraSwitchBtn__20Wt6\"};"],"sourceRoot":""}